provider "malwaredomains"
name "dyndns_domain_reputation"
fetch_http('http://mirror2.malwaredomains.com/files/dynamic_dns.txt')

feed_re = /^(?<domain>[a-z,A-Z,0-9,\-,\.]*)/

filter_whitespace
filter_comments

parse_eachline(:separator => "\n") do |event_generator, record|
  m = feed_re.match(record.data)
  next if m.nil?

  event_generator.call() do |event|
    event.type = :malware_host
    event.add_fqdn(m[:domain])
  end
end
